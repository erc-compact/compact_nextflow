

// Pipeline default params

params {
    fil_files = "/hercules/scratch/vishnu/NEXTFLOW/compact_nextflow/*.fil"
    fft_size = "8388608"
    dm_file = "/hercules/scratch/vishnu/NEXTFLOW/dm_file.txt"
    search_singularity_image = "/hercules/scratch/vishnu/singularity_images/peasoup_latest.sif"
    presto_singularity_image = "/u/vishnu/singularity_images/presto_gpu.sif"
    fold_singularity_image = "/u/vishnu/singularity_images/pulsarx_latest.sif"
    pulsarx_fold_template="/hercules/scratch/vishnu/NEXTFLOW/compact_nextflow/meerkat_fold.template"
    fold_script = "/hercules/scratch/vishnu/NEXTFLOW/compact_nextflow/fold_peasoup_candidates.py"
    min_snr = "8.0"
    acc_start = "-50.0"
    acc_end = "50.0"
    ram_limit_gb = "60.0"
    nh = "4"
    ngpus = "1"
    total_cands_limit = "100000"
    telescope = "meerkat"
    rfifind_time = "2.2"
    rfifind_freqsig = "3.0"
    rfifind_timesig = "10.0"
    rfifind_intfrac = "0.3"
    rfifind_chanfrac = "0.7"
    rfifind_nthreads = "4"
}




// Config file for Hercules cluster

//Set up singularity containers and mount path
singularity {
    enabled = true
    runOptions = '--nv -B /hercules'
}

process {
    executor = 'slurm'

    withLabel: 'short' {
        cpus = 24
        memory = '10 GB'
        queue = 'short.q'
        time = '4h'
    }

    withLabel: 'long' {
        cpus = 1
        memory = '20 GB'
        queue = 'long.q'
        time = '10d'
    }

    withLabel: 'gpu' {
    cpus = 1
    memory = '20 GB'
    queue = 'gpu.q'
    time = '4h'
    clusterOptions = '--gres=gpu:1'
    }

    withLabel: 'gpu_short' {
    cpus = 1
    memory = '20 GB'
    queue = 'short.q'
    time = '1h'
    clusterOptions = '--gres=gpu:1'
    }

    withLabel: 'long_multi' {
        cpus = 48
        memory = '250 GB'
        queue = 'long.q'
        time = '10d'
    }

}



